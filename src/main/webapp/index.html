<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8"/>
<title>形態素解析</title>
<!--[if IE]>
<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" />
<![endif]-->
<!--[if lt IE 9]>
<script>
(function(a){for(var i in a){document.createElement(a[i])}})(['header', 'footer', 'section', 'article', 'aside', 'time', 'hgroup'])
</script>
<![endif]-->
<meta name="viewport" content="width=device-width, minimum-scale=1, maximum-scale=1"/>
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans"/>
<link rel="stylesheet" href="http://lab.hidetake.org/css/bootstrap.min.css"/>
<link rel="stylesheet" href="http://lab.hidetake.org/css/bootstrap-responsive.min.css"/>
<link rel="stylesheet" href="http://lab.hidetake.org/css/global.css"/>
<style>
.loading {
	width: 32px;
	height: 32px;
	margin: auto;
	background-image: url('http://lab.hidetake.org/img/loading1.gif');
	background-repeat: no-repeat;
	background-position: center;
}
.part {
	float: left;
	background: #fff;
	margin: 1px;
}
.part[data-feature='名詞'] { background: khaki; }
.part[data-feature='動詞'] { background: greenyellow; }
.part[data-feature='形容詞'] { background: pink; }
.part[data-feature='副詞'] { background: pink; }
.part[data-feature='記号'] { color: gray; }
.surface {
}
.feature {
	font-size: 80%;
	color: #888;
}
textarea {
	width: 95%;
}
</style>
</head>
<body>
<div class="container">
<ul class="nav nav-pills">
<li><a href="http://lab.hidetake.org/"><i class="icon-home"></i> lab.hidetake.org</a></li>
</ul>
</div>

<div class="container">
<header class="page-header">
<img alt="" src="http://lab.hidetake.org/img/icons/text_kanji.png" align="right" />
<h1>形態素解析</h1>
<p class="lead">Morphological Analysis</p>
</header>

<form class="well">
<textarea data-bind="value: text" rows="8"></textarea>
</form>

<div class="row">
<div class="span11">
<div data-bind="if: error">
<div class="alert alert-error">
<a class="close" data-dismiss="alert">&times;</a>
<h4 class="alert-heading">エラー</h4>
<div data-bind="text: error"></div>
</div>
</div>
<div data-bind="if: loading"><div class="loading"></div></div>
<div id="tokens">
<div data-bind="foreach: tokens">
<div class="part" data-bind="attr: {'data-feature': allFeaturesArray[0], title: reading}, visible: $root.categoriesMap[allFeaturesArray[0]]">
<div class="surface" data-bind="text: surfaceForm"></div>
<div class="feature" data-bind="text: allFeaturesArray[0]"></div>
<div class="feature" data-bind="text: allFeaturesArray[1]"></div>
</div>
</div>
<div style="clear: both;"></div>
</div>
<br/>
</div>
<div class="span1">
<form>
<p data-bind="foreach: categories">
<label class="checkbox">
<input type="checkbox" class="checkbox" data-bind="checked: visible"/>
<span data-bind="text: name"></span>
</label>
</p>
<p><button type="button" class="btn" data-bind="click: enableAllCategories">全選択</button></p>
<p><button type="button" class="btn" data-bind="click: disableAllCategories">クリア</button></p>
</form>
</div>
</div>

<footer>
<div>&copy; hidetake.org, 2012.</div>
<div>Using <a href="http://www.atilika.org/">Kuromoji</a> library.</div>
</footer>
</div>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="http://cloud.github.com/downloads/SteveSanderson/knockout/knockout-2.0.0.js"></script>
<script src="http://lab.hidetake.org/js/bootstrap.min.js"></script>
<script>
$(function () {
	$('#tokens').tooltip({
		selector: 'div.part'
	});
	var categories = ['動詞', '形容詞', '名詞', '連体詞', '副詞', '接続詞', '感動詞', '助動詞', '助詞', '記号'];
	var ViewModel = function () {
		this.text = ko.observable('庭には二羽鶏がいる。');
		this.loading = ko.observable();
		this.error = ko.observable();
		this.tokens = ko.observableArray();
		this.categoriesMap = {};
		this.categories = ko.observableArray($.map(categories, $.proxy(function (name) {
			var visible = ko.observable(true);
			this.categoriesMap[name] = visible;
			return {name: name, visible: visible};
		}, this)));
		this.toggleCategories = function (state) {
			$.each(this.categories(), function (k, v) {
				v.visible(state);
			});
		};
		this.enableAllCategories = function () {
			this.toggleCategories(true);
		};
		this.disableAllCategories = function () {
			this.toggleCategories(false);
		};
		ko.computed(function () {
			$.ajax({
				context: this,
				type: 'POST',
				url: '/api/tokenize',
				data: {text: this.text()},
				dataType: 'json',
				beforeSend: function () {
					this.loading(true);
					this.error(null);
					this.tokens(null);
				},
				complete: function () {
					this.loading(false);
				},
				success: function (v) {
					this.tokens(v);
					this.error(null);
				},
				error: function (xhr, t, e) {
					this.tokens(null);
					this.error(xhr.responseText ? xhr.responseText : e);
				}
			});
		}, this);
	};
	ko.applyBindings(new ViewModel());
});
</script>
<script>
var _gaq=_gaq||[];_gaq.push(['_setAccount','UA-3232369-2']);_gaq.push(['_trackPageview']);
(function(){var ga=document.createElement('script');ga.type='text/javascript';ga.async=true;
ga.src=('https:'==document.location.protocol?'https://ssl':'http://www')+'.google-analytics.com/ga.js';
var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(ga,s);})();
</script>
</body>
</html>